<!DOCTYPE html>
<HTML>
	<HEAD>
		<TITLE>パスワード変更</TITLE>
	</HEAD>
	<BODY>
		<INPUT TYPE="PASSWORD" ID="CUR_PASSWORD" PLACEHOLDER="現在のパスワード">
		<INPUT TYPE="PASSWORD" ID="NEW_PASSWORD" PLACEHOLDER="新しいパスワード">
		<BUTTON onclick="change();">変更</BUTTON>
	</BODY>

	<SCRIPT SRC="https://cdn.rumia.me/LIB/COOKIE.js?V=LATEST"></SCRIPT>
	<SCRIPT SRC="https://cdn.rumia.me/LIB/Login.js?V=LATEST"></SCRIPT>
	<SCRIPT SRC="https://cdn.rumia.me/LIB/DIALOG.js?V=LATEST"></SCRIPT>
	<SCRIPT SRC="Script/Main.js" defer></SCRIPT>
	<SCRIPT defer>
		let mel = {
			field: {
				cur: document.getElementById("CUR_PASSWORD"),
				new: document.getElementById("NEW_PASSWORD")
			}
		};

		async function change() {
			if (mel.field.cur.value == "" || mel.field.new.value == "") {
				dialog.DIALOG("パスワードを入力して");
				return;
			}

			let ajax = await fetch("/api/Secure/Password", {
				method: "POST",
				headers: {
					"TOKEN": session,
					"Content-Type": "application/json; charset=UTF-8",
					"Accept": "application/json; charset=UTF-8"
				},
				body: JSON.stringify({
					"OLD_PASSWORD": mel.field.cur.value,
					"NEW_PASSWORD": mel.field.new.value
				})
			});

			const result = await ajax.json();
			if (result.STATUS) {
				dialog.DIALOG("変更しました");
			} else {
				dialog.DIALOG("エラー！");
			}
		}
	</SCRIPT>
</HTML>